<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Inspección</title>
</head>

<body>

<button onclick="mostrarPopup()">Abrir</button>

<div id="popup" style="display:none;">
  <textarea id="descripcion" placeholder="Descripción"></textarea>
  <input type="file" id="foto">
  <button onclick="guardar()">Guardar</button>
</div>

<script>

function mostrarPopup(){
  document.getElementById("popup").style.display="block";
}

function guardar(){
  const descripcion = document.getElementById("descripcion").value;
  const file = document.getElementById("foto").files[0];

  if(!file){
    alert("Selecciona una imagen");
    return;
  }

  const reader = new FileReader();
  reader.onload = function(){
    enviarDatos(descripcion, reader.result);
  };
  reader.readAsDataURL(file);
}

function enviarDatos(descripcion, fotoBase64){
  fetch("https://script.google.com/macros/s/AKfycbygR-XFaZL4p-kyyI9doVsXdOdHgfaGc6ioBvMzmKWXxMlNzvZ37knQiYnNySCOrPCl4A/exec", {
    method: "POST",
    headers: {
      "Content-Type": "application/json"
    },
    body: JSON.stringify({
      id_estructura: "1",
      x: 0,
      y: 0,
      descripcion: descripcion,
      foto: fotoBase64
    })
  })
  .then(response => response.text())
  .then(data => {
    console.log(data);
    alert("Enviado correctamente");
    location.reload();
  })
  .catch(error => {
    console.error("Error:", error);
  });
}

</script>

</body>
</html>






